{% extends "base.html" %}

{% block title %}{{ work.get_title }}{% endblock %}
{% block content %}
    {% with wis=work.workinseries_set.all %}
        {% with tbl=work.get_sub_works %}
            <div class="flex flex-col gap-3">
                <div class="flex flex-col lg:flex-row gap-3">
                    {% include 'works/partials/main_info.html' %}
                    {% if not series %}
                        {% include 'works/partials/subworks.html' %}
                    {% endif %}
                </div>
                {% if perms.works.change_workrelation %}
                    {% component 'works.relations.Relations' work / %}
                {% endif %}
                {% if not series %}
                    {% with work.get_items as items %}
                        {% if perms.works.change_lending or items %}
                            {% include 'works/partials/items.html' %}
                        {% endif %}
                    {% endwith %}
                {% endif %}
                {% if series %}
                    {% component 'tile.Tile' root_class_tags="lg:basis-64" %}
                        {% fill 'title' %}Series Structure{% endfill %}
                        {% fill 'content' %}
                            <div class="series_tree">
                                <ul>
                                    {% component 'series.Tree' series_graph work / %}
                                </ul>
                            </div>
                        {% endfill %}
                    {% endcomponent %}
                {% endif %}
            </div>
        {% endwith %}
    {% endwith %}
    {% if perms.works.change_workrelation  or perms.works.change_work %}
        {% component 'help_bar' %}
            <h2>Explanation about the works data structure in the system</h2>
            To read up on how the data-model works, you can read it at the link below.

            <a href="{% url 'named_page' 'docs' 'work-edit' %}">Read documentation about it here.</a>
        {% endcomponent %}
    {% endif %}
{% endblock %}
